<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ›¸å¯«å±±ãƒ»å·¡ç¦®å¸– | 8æ—¥å‘¨éŠ</title>
    <style>
        /* --- è¦–è¦ºé¢¨æ ¼è¨­å®š (åœ“æ•™å¯ºãƒ»ç¦ªæ„) --- */
        :root {
            --c-bg: #f4f1ea; /* å’Œç´™ç™½ */
            --c-text: #2c2825; /* å¢¨é»‘ */
            --c-primary: #5c6e58; /* è‹”ç¶  */
            --c-primary-dark: #3a4a36;
            --c-accent: #a63737; /* æœ±å°ç´… */
            --c-wood: #8c7b6c; /* å¤æœ¨è‰² */
            --c-light: #e8e4dc;
            --c-white: #ffffff;
            --shadow: 0 4px 12px rgba(44, 40, 37, 0.08);
            --radius: 12px;
            --font-main: "Helvetica Neue", Helvetica, "PingFang TC", "Microsoft JhengHei", sans-serif;
            --font-serif: "Songti TC", "Noto Serif TC", serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; font-family: var(--font-main); background-color: var(--c-bg); color: var(--c-text); padding-bottom: 90px; }
        
        header { text-align: center; padding: 24px 0; background: linear-gradient(to bottom, var(--c-bg), rgba(244,241,234,0)); position: sticky; top: 0; z-index: 100; backdrop-filter: blur(5px); }
        header h1 { font-family: var(--font-serif); font-size: 1.6rem; color: var(--c-primary-dark); margin: 0; }
        header p { font-size: 0.85rem; color: var(--c-wood); margin-top: 4px; letter-spacing: 1px; }

        .container { max-width: 600px; margin: 0 auto; padding: 0 16px; }
        .card { background: var(--c-white); border-radius: var(--radius); padding: 16px; margin-bottom: 16px; box-shadow: var(--shadow); border-left: 4px solid var(--c-primary); }
        .btn { background: var(--c-primary); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.9rem; transition: 0.2s; display: inline-flex; align-items: center; gap: 5px; text-decoration: none;}
        .btn:active { transform: scale(0.98); }
        
        /* è¡Œç¨‹è¡¨ */
        .day-header { background: var(--c-wood); color: white; padding: 12px 16px; border-radius: var(--radius); margin-bottom: 10px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .day-details { display: none; padding: 8px 0 8px 12px; border-left: 2px dashed var(--c-light); margin-left: 10px; }
        .day-details.open { display: block; animation: slideDown 0.3s ease-out; }
        .timeline-item { position: relative; padding-left: 24px; margin-bottom: 16px; }
        .timeline-item::before { content: ''; position: absolute; left: -5px; top: 6px; width: 12px; height: 12px; background: var(--c-accent); border-radius: 50%; border: 2px solid var(--c-white); }
        .time-badge { font-size: 0.75rem; background: var(--c-primary-dark); color: white; padding: 2px 8px; border-radius: 4px; margin-right: 6px; font-weight: bold; }
        
        /* æ¢ç´¢å¡ç‰‡ */
        .category-scroll { display: flex; overflow-x: auto; gap: 8px; padding-bottom: 10px; margin-bottom: 10px; }
        .pill-btn { white-space: nowrap; padding: 8px 16px; border-radius: 20px; background: var(--c-white); border: 1px solid var(--c-wood); color: var(--c-text); font-size: 0.9rem; transition: 0.2s; cursor: pointer; }
        .pill-btn.active { background: var(--c-primary); color: white; border-color: var(--c-primary); }
        .place-card { background: white; padding: 14px; margin-bottom: 12px; border-radius: 8px; border-left: 4px solid var(--c-accent); box-shadow: var(--shadow); }
        .ai-tip { background: #fff8e1; color: #856404; font-size: 0.85rem; padding: 8px; margin-top: 8px; border-radius: 6px; line-height: 1.4; display: flex; align-items: start; }
        .ai-tip::before { content: 'ğŸ’¡'; margin-right: 6px; }

        /* è¨˜å¸³ */
        .total-box { background: var(--c-primary-dark); color: white; padding: 20px; border-radius: var(--radius); text-align: right; margin-bottom: 20px; }
        .expense-item { display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding: 10px 0; }
        input { padding: 10px; border: 1px solid #ddd; border-radius: 6px; width: 100%; }

        /* å°èˆª */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--c-white); border-top: 1px solid #eee; display: flex; justify-content: space-around; padding: 10px 0; z-index: 999; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); }
        .nav-item { text-align: center; color: #999; font-size: 0.7rem; flex: 1; cursor: pointer; }
        .nav-item.active { color: var(--c-primary); font-weight: bold; }
        .nav-icon { display: block; font-size: 1.4rem; margin-bottom: 2px; }
        .view-section { display: none; animation: fadeIn 0.3s; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<header>
    <h1>æ›¸å¯«å±±ãƒ»å·¡ç¦®å¸–</h1>
    <p>ä¸­åœ‹å››åœ‹ Ã— åœ“æ•™å¯º 8æ—¥ç´€è¡Œ</p>
</header>

<div class="container">
    <div id="view-itinerary" class="view-section active">
        <div class="card" style="background: linear-gradient(135deg, #a8c0ff 0%, #3f2b96 100%); color: white; border:none; display:flex; align-items:center; justify-content:space-between;">
            <div><div style="font-size:0.9rem; opacity:0.8;">12æœˆ / å²¡å±±ãƒ»å§¬è·¯</div><div style="font-size:1.8rem; font-weight:bold;">9Â°C</div></div>
            <div style="text-align:right;"><div style="font-size:2rem;">â˜ï¸</div><div style="font-size:0.8rem;">é©åˆæ´‹è”¥å¼ç©¿æ­</div></div>
        </div>
        <div id="itinerary-list"></div>
    </div>

    <div id="view-explore" class="view-section">
        <div class="category-scroll">
            <button class="pill-btn active" onclick="filterPlaces('play', this)">ç©æ¨‚/æ™¯é»</button>
            <button class="pill-btn" onclick="filterPlaces('food', this)">è¦ªå­å‹å–„ç¾é£Ÿ</button>
            <button class="pill-btn" onclick="filterPlaces('health', this)">è—¥å¦/æ€¥é›£</button>
            <button class="pill-btn" onclick="filterPlaces('conv', this)">ä¾¿åˆ©å•†åº—</button>
        </div>
        
        <div class="card" style="text-align:center; background:#f9f9f9; border:1px dashed #ccc;">
            <div style="font-size:2rem; margin-bottom:10px;">ğŸ—ºï¸</div>
            <p style="color:#666; font-size:0.9rem; margin-bottom:15px;">é»æ“Šä¸‹æ–¹æŒ‰éˆ•ï¼Œç›´æ¥é–‹å•Ÿ Google Maps App å°èˆª</p>
            <a href="https://www.google.com/maps/search/?api=1&query=restaurant" target="_blank" class="btn" style="background:#4285F4;">ğŸ“ æœå°‹é™„è¿‘é¤å»³</a>
        </div>

        <div id="places-list"></div>
    </div>

    <div id="view-wallet" class="view-section">
        <div class="total-box"><small>ç¸½æ”¯å‡º</small><div style="font-size:2rem; font-weight:bold;">Â¥ <span id="total-val">0</span></div></div>
        <div class="card">
            <h3>ğŸ–Šï¸ æ–°å¢è¨˜å¸³</h3>
            <div style="display:flex; gap:10px; margin-top:10px;">
                <input type="text" id="input-item" placeholder="é …ç›®" style="flex:2;">
                <input type="number" id="input-cost" placeholder="é‡‘é¡" style="flex:1;">
            </div>
            <button class="btn" style="width:100%; margin-top:10px;" onclick="addExpense()">åŠ å…¥</button>
        </div>
        <div class="card" id="expense-list" style="min-height:100px;"></div>
    </div>
</div>

<nav class="bottom-nav">
    <div class="nav-item active" onclick="switchView('itinerary', this)"><span class="nav-icon">ğŸ“…</span>è¡Œç¨‹</div>
    <div class="nav-item" onclick="switchView('explore', this)"><span class="nav-icon">ğŸ”</span>æ¢ç´¢</div>
    <div class="nav-item" onclick="switchView('wallet', this)"><span class="nav-icon">ğŸ’°</span>è¨˜å¸³</div>
</nav>

<script>
    // --- 1. è¡Œç¨‹è³‡æ–™ (ä¾æ“šæ‚¨çš„æª”æ¡ˆ) ---
    const itineraryData = [
        { day: "Day 1 (12/10)", title: "æŠµé”å²¡å±±", items: [
            {t:"11:40", c:"æŠµé”å²¡å±±æ©Ÿå ´ -> å·´å£«è‡³å²¡å±±ç«™"}, 
            {t:"14:00", c:"é ˜JR Pass & åŠƒä½ (ç€¨æˆ¶å…§æµ·é€±éŠåˆ¸)"}, 
            {t:"15:00", c:"å¾Œæ¨‚åœ’é£¯åº— Check-in / é«˜å³¶å±‹"} 
        ]},
        { day: "Day 2 (12/11)", title: "é‡‘åˆ€æ¯”ç¾…å®®", items: [
            {t:"08:52", c:"å²¡å±± -> ç´å¹³ (å—é¢¨è™Ÿ)"}, 
            {t:"10:00", c:"é‡‘åˆ€æ¯”ç¾…å®® (å»ºè­°æ­è¨ˆç¨‹è»Šè‡³ç¥æ¤¿)"}, 
            {t:"12:30", c:"åˆé¤ï¼šçƒé¾éºµ"}, 
            {t:"15:45", c:"å²¡å±±å¾Œæ¨‚åœ’ / å²¡å±±åŸ"} 
        ]},
        { day: "Day 3 (12/12)", title: "å§¬è·¯ãƒ»æ›¸å¯«å±±", items: [
            {t:"07:25", c:"å²¡å±± -> å§¬è·¯ (æ–°å¹¹ç·š)"}, 
            {t:"08:10", c:"ç¥å§¬å·´å£«#10 -> æ›¸å¯«å±±çºœè»Š"}, 
            {t:"09:00", c:"åœ“æ•™å¯ºå·¡ç¦® (æœ«ä»£æ­¦å£«å–æ™¯åœ°)"}, 
            {t:"12:00", c:"åˆé¤ï¼šé°»é­šé£¯ Moriju"},
            {t:"13:30", c:"å§¬è·¯åŸã€å¥½å¤åœ’"} 
        ]},
        { day: "Day 4 (12/13)", title: "å€‰æ•· -> æ¾å±±", items: [
            {t:"09:16", c:"å²¡å±± -> å€‰æ•·ç¾è§€åœ°å€"}, 
            {t:"13:11", c:"è¿”å›å²¡å±±å–è¡Œæ"}, 
            {t:"14:35", c:"å²¡å±± -> æ¾å±± (äºˆè®šç·šç‰¹æ€¥)"}, 
            {t:"17:30", c:"å¤§è¡—é“ Check-in / æ™šé¤ï¼šç‚¸è±¬æ’"} 
        ]},
        { day: "Day 5 (12/14)", title: "æ¾å±±åŸãƒ»é“å¾Œ", items: [
            {t:"10:30", c:"æ¾å±±åŸ (çºœè»Š)ã€ä»Šæ²»æ¯›å·¾"}, 
            {t:"13:00", c:"åˆé¤ï¼šé¯›é­šé£¯"}, 
            {t:"15:00", c:"é“å¾Œæº«æ³‰ Check-in"}, 
            {t:"16:00", c:"å°‘çˆºæ©Ÿé—œé˜ã€æº«æ³‰æœ¬é¤¨"} 
        ]},
        { day: "Day 6 (12/15)", title: "æ¸¡è¼ª -> å»£å³¶", items: [
            {t:"10:50", c:"é“å¾Œ -> æ¾å±±æ¸¯"}, 
            {t:"14:15", c:"æ­ä¹˜ SEA PASEO æ¸¡è¼ª"}, 
            {t:"16:57", c:"æŠµé”å»£å³¶æ¸¯ -> å¸‚å€"} 
        ]},
        { day: "Day 7 (12/16)", title: "å®®å³¶ãƒ»å»£å³¶", items: [
            {t:"07:22", c:"å»£å³¶ -> å®®å³¶å£ -> æ¸¡è¼ª"}, 
            {t:"08:30", c:"åš´å³¶ç¥ç¤¾ã€å¤§é³¥å±… (å°å¿ƒé¹¿)"}, 
            {t:"14:30", c:"åŸçˆ†åœ“é ‚ã€å»£å³¶åŸ"}, 
            {t:"18:00", c:"å…«ä¸å € (å»£å³¶ç‡’ã€å”å‰è»»å¾·)"} 
        ]},
        { day: "Day 8 (12/17)", title: "è¿”ç¨‹", items: [
            {t:"07:15", c:"å»£å³¶ç«™ -> æ©Ÿå ´å·´å£« (åŒ—å£5è™Ÿ)"}, 
            {t:"11:15", c:"é£›æ©Ÿèµ·é£› -> 13:10 æŠµé”æ¡ƒåœ’"} 
        ]}
    ];

    // --- 2. æ¨è–¦åœ°é»è³‡æ–™ (å« AI å»ºè­°) ---
    const placesData = {
        play: [
            {name: "åœ“æ•™å¯º (æ‘©å°¼æ®¿)", desc: "èŠåš´éœè¬ï¼Œå»ºè­°ç©¿è‘—å¥½èµ°çš„é‹å­ã€‚", type: "æ™¯é»"},
            {name: "å§¬è·¯åŸè¥¿ä¹‹ä¸¸åº­åœ’", desc: "é©åˆå­©å­è·‘è·³ï¼Œæ‹ç…§æ¥µä½³ã€‚", type: "æ™¯é»"},
            {name: "å€‰æ•·å¸¸æ˜¥è—¤å»£å ´", desc: "å¾©å¤ç´…ç£šå»ºç¯‰ï¼Œæœ‰è¨±å¤šæ‰‹ä½œé«”é©—ã€‚", type: "é«”é©—"}
        ],
        food: [
            {name: "Moriju (å§¬è·¯)", desc: "é°»é­šé£¯è€åº—ï¼Œæœ‰å¡Œå¡Œç±³åº§ä½é©åˆå°å­©ã€‚", type: "é¤å»³"},
            {name: "äº”å¿—å–œ (æ¾å±±)", desc: "é„‰åœŸæ–™ç†é¯›é­šé£¯ï¼Œç’°å¢ƒå‹å–„ã€‚", type: "é¤å»³"},
            {name: "å€‰æ•·æ¡ƒå­", desc: "ç•¶å­£æ°´æœè–ä»£ï¼Œå­©å­æœ€æ„›ã€‚", type: "ç”œé»"}
        ],
        health: [
            {name: "å¤§åœ‹è—¥å¦", desc: "å¯è²·å…’ç«¥å‚™ç”¨è—¥ã€é€€ç†±è²¼ã€‚", type: "è—¥å¦"},
            {name: "æ¾å±±å¸‚ç«‹æ€¥æ‚£ä¸­å¿ƒ", desc: "ç·Šæ€¥å‚™ç”¨è³‡è¨Šï¼Œå¤œé–“è¨ºç™‚ã€‚", type: "é†«ç™‚"}
        ],
        conv: [
            {name: "Lawson", desc: "å¯è³¼è²·ç‚¸é›å›ã€é£¯ç³°ç•¶é»å¿ƒã€‚", type: "è¶…å•†"},
            {name: "7-11", desc: "å¯ä½¿ç”¨ ATM æé ˜æ—¥å¹£ã€‚", type: "è¶…å•†"}
        ]
    };

    let expenses = [];
    try { expenses = JSON.parse(localStorage.getItem('tripExp')) || []; } catch(e){ expenses=[]; }

    // --- 3. æ ¸å¿ƒé‚è¼¯ ---
    document.addEventListener('DOMContentLoaded', () => {
        renderItinerary();
        renderExpenses();
        filterPlaces('play'); // é è¨­è¼‰å…¥
    });

    function switchView(viewName, navEl) {
        document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
        document.getElementById(`view-${viewName}`).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        navEl.classList.add('active');
    }

    function renderItinerary() {
        const list = document.getElementById('itinerary-list');
        list.innerHTML = itineraryData.map((day, idx) => `
            <div class="card">
                <div class="day-header" onclick="toggleDay(${idx})">
                    <b>${day.day} ${day.title}</b> <span>â–¼</span>
                </div>
                <div class="day-details ${idx===0?'open':''}" id="day-${idx}">
                    ${day.items.map(item => `
                        <div class="timeline-item">
                            <span class="time-badge">${item.t}</span> ${item.c}
                        </div>
                    `).join('')}
                </div>
            </div>
        `).join('');
    }

    function toggleDay(idx) {
        document.getElementById(`day-${idx}`).classList.toggle('open');
    }

    function filterPlaces(cat, btn) {
        if(btn) {
            document.querySelectorAll('.pill-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }
        
        const list = document.getElementById('places-list');
        // æ ¹æ“šä¸åŒåˆ†é¡ï¼Œè¨­å®šæŒ‰éˆ•æœå°‹çš„é—œéµå­—
        let searchKey = "";
        if(cat==='play') searchKey = "attractions";
        if(cat==='food') searchKey = "restaurant";
        if(cat==='health') searchKey = "drugstore";
        if(cat==='conv') searchKey = "convenience store";

        const baseHtml = `
            <div style="text-align:right; margin-bottom:10px;">
                <a href="https://www.google.com/maps/search/?api=1&query=${searchKey}" target="_blank" class="btn" style="font-size:0.8rem;">ğŸ” æœå°‹æ›´å¤šé™„è¿‘çš„${searchKey}</a>
            </div>
        `;

        const itemsHtml = placesData[cat].map(p => `
            <div class="place-card">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div style="font-weight:bold; font-size:1.1rem;">${p.name}</div>
                    <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(p.name)}" target="_blank" class="btn" style="padding:4px 10px; font-size:0.8rem;">å°èˆª â†—</a>
                </div>
                <div style="color:#666; font-size:0.9rem; margin:4px 0;">åˆ†é¡ï¼š${p.type}</div>
                <div class="ai-tip">ğŸ’¡ çˆ¸åª½ Noteï¼š${p.desc}</div>
            </div>
        `).join('');

        list.innerHTML = baseHtml + itemsHtml;
    }

    function renderExpenses() {
        let total = 0;
        document.getElementById('expense-list').innerHTML = expenses.map((ex, idx) => {
            total += parseInt(ex.cost);
            return `
                <div class="expense-item">
                    <span>${ex.item}</span>
                    <span>Â¥${Number(ex.cost).toLocaleString()} <span onclick="delExpense(${idx})" style="color:red; margin-left:8px; cursor:pointer;">Ã—</span></span>
                </div>
            `;
        }).join('');
        document.getElementById('total-val').innerText = total.toLocaleString();
    }
    
    function addExpense() {
        const item = document.getElementById('input-item').value;
        const cost = document.getElementById('input-cost').value;
        if(item && cost) {
            expenses.push({item, cost});
            localStorage.setItem('tripExp', JSON.stringify(expenses));
            renderExpenses();
            document.getElementById('input-item').value = '';
            document.getElementById('input-cost').value = '';
        }
    }
    
    function delExpense(idx) {
        expenses.splice(idx, 1);
        localStorage.setItem('tripExp', JSON.stringify(expenses));
        renderExpenses();
    }
</script>

</body>
</html>
